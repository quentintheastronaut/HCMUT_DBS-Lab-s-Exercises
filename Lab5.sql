CREATE TABLE DEPT (
    DEPTNO SMALLINT NOT NULL,
    DNAME CHAR(14),
    LOC CHAR(13),
    PRIMARY KEY(DEPTNO)
);

CREATE TABLE SALGRADE (
    GRADE INT,
    LOSAL INT,
    HISAL INT,
    PRIMARY KEY(GRADE)
);

CREATE TABLE EMP (
    EMPNO INT NOT NULL,
    ENAME CHAR(10),
    JOB CHAR(9),
    MGR INT,
    HIREDATE DATE,
    SAL DECIMAL(7,2),
    DEPTNO INT NOT NULL,

    PRIMARY KEY(EMPNO),
    FOREIGN KEY (MGR) REFERENCES EMP(EMPNO)
)

DROP TABLE EMP;

SELECT * FROM DEPT
SELECT * FROM SALGRADE
SELECT * FROM EMP

INSERT INTO DEPT VALUES(10,'Headquater','R101');
INSERT INTO DEPT VALUES(20,'Marketing','R102');
INSERT INTO DEPT VALUES(30,'Sales','R103');

INSERT INTO SALGRADE VALUES (1,700,1200);
INSERT INTO SALGRADE VALUES (2,1201,1400);
INSERT INTO SALGRADE VALUES (3,1401,2000);
INSERT INTO SALGRADE VALUES (4,2001,3000);
INSERT INTO SALGRADE VALUES (5,3001,9999);

INSERT INTO EMP VALUES(7839,'KING','PRESIDENT', NULL ,CONVERT(datetime, '17-11-1981', 105),5000,10);
INSERT INTO EMP VALUES(7698,'BLAKE','MANAGER',7839,CONVERT(datetime, '01-05-1981', 105),2850,30);
INSERT INTO EMP VALUES(7782,'CLARK','MANAGER',7839,CONVERT(datetime, '09-06-1981', 105),2450,10);
INSERT INTO EMP VALUES(7566,'JONES','MANAGER',7839,CONVERT(datetime, '02-04-1981', 105),2975,20);
INSERT INTO EMP VALUES(7654,'MARTIN','SALESMAN',7698,CONVERT(datetime, '28-09-1981', 105),1250,30);

INSERT INTO EMP VALUES(7499,'ALLEN','SALESMAN', 7698 ,CONVERT(datetime, '17-11-1981', 105),5000,10);
INSERT INTO EMP VALUES(7844,'TURNER','SALESMAN',7698,CONVERT(datetime, '01-05-1981', 105),2850,30);
INSERT INTO EMP VALUES(7900,'JAMES','CLERK',7698,CONVERT(datetime, '09-06-1981', 105),2450,10);
INSERT INTO EMP VALUES(7521,'WARD','SALESMAN',7698,CONVERT(datetime, '02-04-1981', 105),2975,20);
INSERT INTO EMP VALUES(7902,'FORD','ANALYST',7566,CONVERT(datetime, '28-09-1981', 105),1250,30);
INSERT INTO EMP VALUES(7369,'SMITH','CLERK',7902,CONVERT(datetime, '01-05-1980', 105),2850,30);
INSERT INTO EMP VALUES(7788,'SCOTT','ANALYST',7566,CONVERT(datetime, '09-06-1982', 105),2450,10);
INSERT INTO EMP VALUES(7876,'ADAMS','CLERK',7788,CONVERT(datetime, '02-04-1983', 105),2975,20);
INSERT INTO EMP VALUES(7934,'MILLER','CLERK',7782,CONVERT(datetime, '02-04-1982', 105),2975,20);

ALTER TABLE DEPT
ADD CONSTRAINT Pk_Dept PRIMARY KEY (DEPTNO);





-- Cau a:

SELECT ENAME, DEPTNO, SAL
FROM EMP
WHERE SAL >= 1000 AND SAL <= 2000;

-- Cau b:

SELECT DEPTNO,DNAME
FROM DEPT
ORDER BY DNAME;

-- Cau c:

SELECT EMPNO,ENAME
FROM EMP
WHERE DEPTNO = 10 OR DEPTNO = 20;

-- Cau d:

SELECT ENAME, JOB
FROM EMP
WHERE JOB = 'CLERK' AND DEPTNO = 20;

-- Cau e:

SELECT EMPNO,ENAME
FROM EMP
WHERE ENAME LIKE '%TH%' OR ENAME LIKE '%LL%';

-- Cau f:

SELECT ENAME,JOB,SAL
FROM EMP
WHERE MGR = (
    SELECT EMPNO
    FROM EMP
    WHERE JOB = 'PRESIDENT'
);

-- Cau g:

SELECT ENAME,DEPTNO,HIREDATE
FROM EMP
WHERE YEAR(HIREDATE) = 1983; 

-- Cau h:

SELECT ENAME , HIREDATE , DATEADD(year,1,HIREDATE) AS CHANGESALDATE
FROM EMP
ORDER BY CHANGESALDATE

-- Cau i:
SELECT MIN(SAL) AS MIN_SAL, MAX(SAL) AS MAX_SAL, AVG(SAL) AS AVG_SAL
FROM EMP;

-- Cau j:

SELECT JOB,MIN(SAL) AS MIN_SAL, MAX(SAL) AS MAX_SAL
FROM EMP
GROUP BY JOB;

-- Cau k:
SELECT COUNT(EMPNO) AS number_of_president
FROM EMP
WHERE JOB = 'PRESIDENT';

-- Cau l:

SELECT DEPTNO, COUNT(EMPNO) 
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(EMPNO)  > 3


-- Cau m:

SELECT ENAME,GRADE
FROM EMP,SALGRADE
WHERE MGR IN (
    SELECT EMPNO
    FROM EMP
    WHERE JOB = 'PRESIDENT'
) AND SAL BETWEEN LOSAL AND HISAL
ORDER BY SAL;

-- Cau n:

SELECT ENAME,LOC,DNAME
FROM EMP JOIN DEPT ON EMP.DEPTNO = DEPT.DEPTNO
WHERE SAL > 1500

-- Cau o:

SELECT ENAME,JOB,GRADE,SAL,DNAME
FROM (EMP JOIN DEPT ON EMP.DEPTNO = DEPT.DEPTNO) ,SALGRADE 
WHERE JOB <> 'CLERK' AND SAL BETWEEN LOSAL AND HISAL
ORDER BY SAL DESC;

-- Cau p:

SELECT JOB 
FROM EMP
WHERE YEAR(HIREDATE) = 1981 
AND JOB NOT IN (
    SELECT JOB 
    FROM EMP
    WHERE YEAR(HIREDATE) = 1994
);

-- Cau q:

SELECT ENAME 
FROM EMP
WHERE HIREDATE < (
    SELECT HIREDATE
    FROM EMP
    WHERE JOB = 'PRESIDENT'
);




